<!-- TODO these are mocks! remove me after integration -->
<policies>
    <inbound>
        <base/>
        <set-variable name="institutionId" value="@(context.Request.Url.Query.GetValueOrDefault("institutionId",""))" />
        <choose>
            <when condition="@(((string)context.Variables["institutionId"]).Equals("infoError"))">
                <return-response>
                    <set-status code="400" reason="Invalid ID supplied"/>
                    <set-header name="Content-Type" exists-action="override">
                        <value>application/json</value>
                    </set-header>
                    <set-body>
                        {
                        "detail": "Request took too long to complete.",
                        "status": 503,
                        "title": "Service Unavailable"
                        }
                    </set-body>
                </return-response>
            </when>
            <when condition="@(((string)context.Variables["institutionId"]).Equals("onboarded"))">
                <return-response>
                    <set-status code="200" reason="OK"/>
                    <set-header name="Content-Type" exists-action="override">
                        <value>application/json</value>
                    </set-header>
                    <set-body>
                        {
                        "person": {
                        "name": "name",
                        "surname": "surname",
                        "taxCode": "AAAAAA00A00A000A"
                        },
                        "institutions": [
                        {
                        "institutionId": "onboarded",
                        "description": "AGENCY ONBOARDED",
                        "taxCode":"onboardedFiscalCode",
                        "digitalAddress": "digitalAddress",
                        "state": "ACTIVE",
                        "role": "MANAGER",
                        "productInfo": {
                            "id": "pagoPA",
                            "role": "ADMIN",
                            "createdAt": "2021-12-02T16:57:02.300Z"
                        },
                        "attributes": [
                            {
                            "id":"attId",
                            "name":"attName",
                            "description":"attDescription"
                            ]
                        }
                        ]
                        }
                    </set-body>
                </return-response>
            </when>
            <when condition="@(((string)context.Variables["institutionId"]).Equals("pending"))">
                <return-response>
                    <set-status code="200" reason="OK"/>
                    <set-header name="Content-Type" exists-action="override">
                        <value>application/json</value>
                    </set-header>
                    <set-body>
                        {
                        "person": {
                        "name": "name",
                        "surname": "surname",
                        "taxCode": "AAAAAA00A00A000A"
                        },
                        "institutions": [
                        {
                        "institutionId": "pending",
                        "description": "AGENCY PENDING",
                        "taxCode":"pendingFiscalCode",
                        "digitalAddress": "digitalAddress",
                        "state": "PENDING",
                        "role": "MANAGER",
                        "productInfo": {
                        "id": "pagoPA",
                        "role": "LIMITED",
                        "createdAt": "2021-12-02T16:57:02.300Z"
                        },
                        "attributes": [
                            {
                            "id":"attId",
                            "name":"attName",
                            "description":"attDescription"
                        ]
                        }
                        ]
                        }
                    </set-body>
                </return-response>
            </when>
            <when condition="@(((string)context.Variables["institutionId"]).Equals("id"))">
                <return-response>
                    <set-status code="200" reason="OK"/>
                    <set-header name="Content-Type" exists-action="override">
                        <value>application/json</value>
                    </set-header>
                    <set-body>
                        {
                        "person": {
                        "name": "name",
                        "surname": "surname",
                        "taxCode": "AAAAAA00A00A000A"
                        },
                        "institutions": []
                        }
                    </set-body>
                </return-response>
            </when>
            <when condition="@(((string)context.Variables["institutionId"]).Equals("pippo"))">
                <return-response>
                    <set-status code="200" reason="OK" />
                    <set-header name="Content-Type" exists-action="override">
                        <value>application/json</value>
                    </set-header>
                    <set-body>{
                        "person": {
                        "name": "string",
                        "surname": "string",
                        "taxCode": "string"
                        },
                        "institutions": [
                        {
                        "institutionId": "pippo",
                        "description": "string",
                        "taxCode": "string",
                        "digitalAddress": "string",
                        "state": "ACTIVE",
                        "role": "MANAGER",
                        "productInfo": {
                        "id": "productId",
                        "role": "ADMIN",
                        "createdAt": "2021-12-01T17:15:38.101Z"
                        },
                        "attributes": [
                        {
                        "id": "string",
                        "name": "string",
                        "description": "category"
                        }
                        ]
                        }
                        ]
                        }
                    </set-body>
                </return-response>
            </when>
            <when condition="@(((string)context.Variables["institutionId"]).Equals("pluto"))">
                <return-response>
                    <set-status code="200" reason="OK" />
                    <set-header name="Content-Type" exists-action="override">
                        <value>application/json</value>
                    </set-header>
                    <set-body>{
                        "person": {
                        "name": "string",
                        "surname": "string",
                        "taxCode": "string"
                        },
                        "institutions": [
                        {
                        "institutionId": "pluto",
                        "description": "string",
                        "taxCode": "string",
                        "digitalAddress": "string",
                        "state": "ACTIVE",
                        "role": "OPERATOR",
                        "productInfo": {
                        "id": "productId",
                        "role": "LIMITED",
                        "createdAt": "2021-12-01T17:15:38.101Z"
                        },
                        "attributes": [
                        {
                        "id": "string",
                        "name": "string",
                        "description": "category"
                        }
                        ]
                        }
                        ]
                        }
                    </set-body>
                </return-response>
            </when>
            <when condition="@(((string)context.Variables["institutionId"]).Equals("paperino"))">
                <return-response>
                    <set-status code="200" reason="OK" />
                    <set-header name="Content-Type" exists-action="override">
                        <value>application/json</value>
                    </set-header>
                    <set-body>{
                        "person": {
                        "name": "string",
                        "surname": "string",
                        "taxCode": "string"
                        },
                        "institutions": [
                        {
                        "institutionId": "paperino",
                        "description": "string",
                        "taxCode": "string",
                        "digitalAddress": "string",
                        "state": "ACTIVE",
                        "role": "MANAGER",
                        "productInfo": {
                        "id": "productId1",
                        "role": "ADMIN",
                        "createdAt": "2021-12-01T17:15:38.101Z"
                        },
                        "attributes": [
                        {
                        "id": "string",
                        "name": "string",
                        "description": "category"
                        }
                        ]
                        },
                        {
                        "institutionId": "paperino",
                        "description": "string",
                        "taxCode": "string",
                        "digitalAddress": "string",
                        "state": "ACTIVE",
                        "role": "OPERATOR",
                        "productInfo": {
                        "id": "productId2",
                        "role": "LIMITED",
                        "createdAt": "2021-12-01T17:15:38.101Z"
                        },
                        "attributes": [
                        {
                        "id": "string",
                        "name": "string",
                        "description": "category"
                        }
                        ]
                        }
                        ]
                        }
                    </set-body>
                </return-response>
            </when>
            <otherwise>
                <return-response>
                    <set-status code="200" reason="OK"/>
                    <set-header name="Content-Type" exists-action="override">
                        <value>application/json</value>
                    </set-header>
                    <set-body>
                        {
                            "person": {
                                "name": "name",
                                "surname": "surname",
                                "taxCode": "AAAAAA00A00A000A"
                            },
                            "institutions": [
                                {
                                "role": "MANAGER",
                                "description": "Comune di Bari",
                                "taxCode":"ComunediBariFiscalCode",
                                "state": "PENDING",
                                "institutionId": "1",
                                "attributes": [],
                                "digitalAddress": "",
                                "productInfo": {
                                "id":"pagoPA",
                                "role":"ADMIN",
                                "createdAt":"2021-12-02T16:57:02.300Z"
                                },
                                },
                                {
                                "role": "MANAGER",
                                "description": "Comune di Milano",
                                "taxCode":"ComunediMilanoFiscalCode",
                                "state": "PENDING",
                                "institutionId": "2",
                                "attributes": [],
                                "digitalAddress": "",
                                "productInfo": {
                                "id":"pagoPA",
                                "role":"LIMITED",
                                "createdAt":"2021-12-02T16:57:02.300Z"
                                },
                                },
                                {
                                "role": "MANAGER",
                                "description": "Comune di Roma",
                                "taxCode":"ComunediRomaFiscalCode",
                                "state": "ACTIVE",
                                "institutionId": "3",
                                "attributes": [],
                                "digitalAddress": "",
                                "productInfo": {
                                "id":"pagoPA",
                                "role":"ADMIN",
                                "createdAt":"2021-12-02T16:57:02.300Z"
                                },
                                },
                                {
                                "role": "MANAGER",
                                "description": "Comune di Napoli",
                                "taxCode":"ComunediNapoliFiscalCode",
                                "state": "ACTIVE",
                                "institutionId": "4",
                                "attributes": [],
                                "digitalAddress": "",
                                "productInfo": {
                                "id":"pagoPA",
                                "role":"LIMITED",
                                "createdAt":"2021-12-02T16:57:02.300Z"
                                },
                                },
                                {
                                "institutionId": "onboarded",
                                "description": "AGENCY ONBOARDED",
                                "taxCode":"onboardedFiscalCode",
                                "digitalAddress": "digitalAddress",
                                "state": "ACTIVE",
                                "role": "MANAGER",
                                "productInfo": {
                                "id":"pagoPA",
                                "role":"ADMIN",
                                "createdAt":"2021-12-02T16:57:02.300Z"
                                },
                                "attributes": [
                                "string"
                                ]
                                }
                            ]
                        }
                    </set-body>
                </return-response>
            </otherwise>
        </choose>
    </inbound>
    <backend>
        <base/>
    </backend>
    <outbound>
        <base/>
    </outbound>
    <on-error>
        <base/>
    </on-error>
</policies>
